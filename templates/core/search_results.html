{% extends 'layouts/dashboard.html' %}
{% load static %}
{% load i18n %}

{% block page_title %}{% trans "Search Results" %}{% endblock %}
{% block page_description %}{% trans "Search results for: " %} {{ query }}{% endblock %}

{% block content %}

{% if not query %}
<div class="alert alert-info border-0 bg-info alert-dismissible fade show py-2">
    <div class="d-flex align-items-center">
        <div class="font-35 text-white"><i class="bx bx-info-circle"></i></div>
        <div class="ms-3">
            <h6 class="mb-0 text-white">Enter a search term</h6>
            <div class="text-white">Please enter a keyword to search for students or staff.</div>
        </div>
    </div>
</div>
{% else %}

<div class="row">
    <!-- Student Results -->
    <div class="col-12 col-lg-6">
        <div class="card radius-10">
            <div class="card-header bg-transparent border-bottom-0">
                <div class="d-flex align-items-center">
                    <div>
                        <h6 class="mb-0"><i class='bx bx-user me-2'></i>Students Found</h6>
                    </div>
                </div>
            </div>
            <div class="card-body p-0">
                {% if students %}
                <div class="table-responsive">
                    <table class="table align-middle mb-0 table-hover">
                        <tbody>
                            {% for student in students %}
                            <tr>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="recent-product-img">
                                            {% if student.photo %}
                                            <img src="{{ student.photo.url }}" alt="">
                                            {% else %}
                                            <img src="{% static 'assets/images/defaults/student_default.png' %}" alt="">
                                            {% endif %}
                                        </div>
                                        <div class="ms-2">
                                            <h6 class="mb-1 font-14">{{ student.get_full_name }}</h6>
                                            <p class="mb-0 font-13 text-secondary">{{ student.admission_number }}</p>
                                        </div>
                                    </div>
                                </td>
                                <td>{{ student.current_class.name }} - {{ student.section.name }}</td>
                                <td>
                                    <a href="{% url 'students:student_detail' student.id %}" class="btn btn-sm btn-primary">View</a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="text-center p-4">
                    <p class="text-muted mb-0">No students found.</p>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Staff Results -->
    <div class="col-12 col-lg-6">
        <div class="card radius-10">
            <div class="card-header bg-transparent border-bottom-0">
                <div class="d-flex align-items-center">
                    <div>
                        <h6 class="mb-0"><i class='bx bx-briefcase me-2'></i>Staff Found</h6>
                    </div>
                </div>
            </div>
            <div class="card-body p-0">
                {% if staff_members %}
                <div class="table-responsive">
                    <table class="table align-middle mb-0 table-hover">
                        <tbody>
                            {% for member in staff_members %}
                            <tr>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="recent-product-img">
                                            {% if member.user.avatar %}
                                            <img src="{{ member.user.avatar.url }}" alt="">
                                            {% else %}
                                            <img src="{% static 'assets/images/defaults/staff_default.png' %}" alt="">
                                            {% endif %}
                                        </div>
                                        <div class="ms-2">
                                            <h6 class="mb-1 font-14">{{ member.user.get_full_name }}</h6>
                                            <p class="mb-0 font-13 text-secondary">{{ member.designation.name }}</p>
                                        </div>
                                    </div>
                                </td>
                                <td>{{ member.department.name }}</td>
                                <td>
                                    <a href="{% url 'hr:staff_detail' member.id %}" class="btn btn-sm btn-primary">View</a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="text-center p-4">
                    <p class="text-muted mb-0">No staff found.</p>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

{% endif %}
{% endblock %}
